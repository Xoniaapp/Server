generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["fullTextSearch", "relationJoins"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id String @id @unique

  username String @unique

  email String  @unique
  phone String? @unique

  avatar_hash String @unique
  banner_hash String @unique

  banner String
  avatar String

  // flags
  verified Boolean @default(false)
  two_fa   Boolean @default(false)

  bio      String?
  pronouns String?

  // secrets
  two_fa_key String @unique

  created_at DateTime @default(now())
  updated_at DateTime @updatedAt

  @@index([id, username, email, avatar_hash, banner_hash])
  @@map("users")
}

// a guild is same as a server
model Guild {
  id String @id @unique

  icon   String?
  banner String?

  icon_hash   String? @unique
  banner_hash String? @unique

  name        String
  description String

  mfa_level          String // todo
  nsfw_level         String // otodo
  notification_level String // todo
  verification_level String // todo
  features           String // todo

  @@index([id])
  @@map("guilds")
}
